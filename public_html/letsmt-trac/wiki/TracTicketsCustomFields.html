<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      TracTicketsCustomFields â€“ LetsMT
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="http://opus.nlpl.eu/letsmt-trac/search" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?format=txt" type="text/x-trac-wiki" title="Plain Text" /><link rel="alternate" href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?format=tex" type="text/x-trac-wiki" title="Latex" /><link rel="alternate" href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?format=pdf" type="text/x-trac-wiki" title="Latex-Pdf" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/messages/en_US.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/folding.js"></script>
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://www.letsmt.eu/"><img src="http://stp.lingfil.uu.se/~joerg/LetsMT/letsmt.jpg" alt="LetsMT" width="100" /></a>
      </div>
      <form id="search" action="http://opus.nlpl.eu/letsmt-trac/search" method="get">
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://opus.nlpl.eu/letsmt-trac/login">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="../wiki.html">Wiki</a></li><li class="last"><a href="../roadmap.html">Roadmap</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="../wiki.html">wiki:</a><a class="pathentry" href="TracTicketsCustomFields.html" title="View TracTicketsCustomFields">TracTicketsCustomFields</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><a href="WikiStart.html">Start Page</a></li><li><a href="TitleIndex.html">Index</a></li><li class="last"><a href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?action=history">History</a></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <div id="wikipage" class="trac-content"><h1 id="CustomTicketFields">Custom Ticket Fields</h1>
<p>
Trac supports adding custom, user-defined fields to the ticket module. Using custom fields, you can add typed, site-specific properties to tickets.
</p>
<h2 id="Configuration">Configuration</h2>
<p>
Configuring custom ticket fields is done in the <a class="wiki" href="TracIni.html">trac.ini</a> file. All field definitions should be under a section named <tt>[ticket-custom]</tt>.
</p>
<p>
The syntax of each field definition is:
</p>
<pre class="wiki"> FIELD_NAME = TYPE
 (FIELD_NAME.OPTION = VALUE)
 ...
</pre><p>
The example below should help to explain the syntax.
</p>
<h3 id="AvailableFieldTypesandOptions">Available Field Types and Options</h3>
<ul><li><strong>text</strong>: A simple (one line) text field.
<ul><li>label: Descriptive label.
</li><li>value: Default value.
</li><li>order: Sort order placement. (Determines relative placement in forms with respect to other custom fields.)
</li><li>format: One of: 
<ul><li><tt>plain</tt> for plain text 
</li><li><tt>wiki</tt> to interpret the content as <a class="wiki" href="WikiFormatting.html">WikiFormatting</a>
</li><li><tt>reference</tt> to treat the content as a queryable value (<em>since 1.0</em>) 
</li><li><tt>list</tt> to interpret the content as a list of queryable values, separated by whitespace (<em>since 1.0</em>)
</li></ul></li></ul></li><li><strong>checkbox</strong>: A boolean value check box.
<ul><li>label: Descriptive label.
</li><li>value: Default value (0 or 1).
</li><li>order: Sort order placement.
</li></ul></li><li><strong>select</strong>: Drop-down select box. Uses a list of values.
<ul><li>label: Descriptive label.
</li><li>options: List of values, separated by <strong>|</strong> (vertical pipe).
</li><li>value: Default value (one of the values from options).
</li><li>order: Sort order placement.
</li></ul></li><li><strong>radio</strong>: Radio buttons. Essentially the same as <strong>select</strong>.
<ul><li>label: Descriptive label.
</li><li>options: List of values, separated by <strong>|</strong> (vertical pipe).
</li><li>value: Default value (one of the values from options).
</li><li>order: Sort order placement.
</li></ul></li><li><strong>textarea</strong>: Multi-line text area.
<ul><li>label: Descriptive label.
</li><li>value: Default text.
</li><li>cols: Width in columns
</li><li>rows: Height in lines.
</li><li>order: Sort order placement.
</li><li>format: Either <tt>plain</tt> for plain text or <tt>wiki</tt> to interpret the content as <a class="wiki" href="WikiFormatting.html">WikiFormatting</a>.
</li></ul></li></ul><p>
Macros will be expanded when rendering <tt>textarea</tt> fields with format <tt>wiki</tt>, but not when rendering <tt>text</tt> fields with format <tt>wiki</tt>.
</p>
<h3 id="SampleConfig">Sample Config</h3>
<pre class="wiki">[ticket-custom]

test_one = text
test_one.label = Just a text box

test_two = text
test_two.label = Another text-box
test_two.value = Default [mailto:joe@nospam.com owner]
test_two.format = wiki

test_three = checkbox
test_three.label = Some checkbox
test_three.value = 1

test_four = select
test_four.label = My selectbox
test_four.options = one|two|third option|four
test_four.value = two

test_five = radio
test_five.label = Radio buttons are fun
test_five.options = uno|dos|tres|cuatro|cinco
test_five.value = dos

test_six = textarea
test_six.label = This is a large textarea
test_six.value = Default text
test_six.cols = 60
test_six.rows = 30
</pre><p>
<em>Note: To make entering an option for a <tt>select</tt> type field optional, specify a leading <tt>|</tt> in the <tt>fieldname.options</tt> option.</em>
</p>
<h3 id="ReportsInvolvingCustomFields">Reports Involving Custom Fields</h3>
<p>
Custom ticket fields are stored in the <tt>ticket_custom</tt> table, not in the <tt>ticket</tt> table. So to display the values from custom fields in a report, you will need a join on the 2 tables. Let's use an example with a custom ticket field called <tt>progress</tt>.
</p>
<div class="code"><pre><span class="k">SELECT</span> p<span class="p">.</span>value <span class="k">AS</span> __color__<span class="p">,</span>
   id <span class="k">AS</span> ticket<span class="p">,</span> summary<span class="p">,</span> <span class="k">owner</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span>value <span class="k">AS</span> progress
  <span class="k">FROM</span> ticket t<span class="p">,</span> enum p<span class="p">,</span> ticket_custom <span class="k">c</span>
  <span class="k">WHERE</span> status <span class="k">IN</span> <span class="p">(</span><span class="s1">'assigned'</span><span class="p">)</span> <span class="k">AND</span> t<span class="p">.</span>id <span class="o">=</span> <span class="k">c</span><span class="p">.</span>ticket <span class="k">AND</span> <span class="k">c</span><span class="p">.</span>name <span class="o">=</span> <span class="s1">'progress'</span>
<span class="k">AND</span> p<span class="p">.</span>name <span class="o">=</span> t<span class="p">.</span>priority <span class="k">AND</span> p<span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'priority'</span>
  <span class="k">ORDER</span> <span class="k">BY</span> p<span class="p">.</span>value
</pre></div><p>
<strong>Note</strong> that this will only show tickets that have progress set in them, which is <strong>not the same as showing all tickets</strong>. If you created this custom ticket field <em>after</em> you have already created some tickets, they will not have that field defined, and thus they will never show up on this ticket query. If you go back and modify those tickets, the field will be defined, and they will appear in the query. If that's all you want, you're set.
</p>
<p>
However, if you want to show all ticket entries (with progress defined and without), you need to use a <tt>JOIN</tt> for every custom field that is in the query.
</p>
<div class="code"><pre><span class="k">SELECT</span> p<span class="p">.</span>value <span class="k">AS</span> __color__<span class="p">,</span>
   id <span class="k">AS</span> ticket<span class="p">,</span> summary<span class="p">,</span> component<span class="p">,</span> <span class="k">version</span><span class="p">,</span> milestone<span class="p">,</span> severity<span class="p">,</span>
   <span class="p">(</span><span class="k">CASE</span> status <span class="k">WHEN</span> <span class="s1">'assigned'</span> <span class="k">THEN</span> <span class="k">owner</span><span class="o">||</span><span class="s1">' *'</span> <span class="k">ELSE</span> <span class="k">owner</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="k">owner</span><span class="p">,</span>
   time <span class="k">AS</span> created<span class="p">,</span>
   changetime <span class="k">AS</span> _changetime<span class="p">,</span> description <span class="k">AS</span> _description<span class="p">,</span>
   reporter <span class="k">AS</span> _reporter<span class="p">,</span>
  <span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="k">c</span><span class="p">.</span>value <span class="o">=</span> <span class="s1">'0'</span> <span class="k">THEN</span> <span class="s1">'None'</span> <span class="k">ELSE</span> <span class="k">c</span><span class="p">.</span>value <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> progress
  <span class="k">FROM</span> ticket t
     <span class="k">LEFT</span> <span class="k">OUTER</span> <span class="k">JOIN</span> ticket_custom <span class="k">c</span> <span class="k">ON</span> <span class="p">(</span>t<span class="p">.</span>id <span class="o">=</span> <span class="k">c</span><span class="p">.</span>ticket <span class="k">AND</span> <span class="k">c</span><span class="p">.</span>name <span class="o">=</span> <span class="s1">'progress'</span><span class="p">)</span>
     <span class="k">JOIN</span> enum p <span class="k">ON</span> p<span class="p">.</span>name <span class="o">=</span> t<span class="p">.</span>priority <span class="k">AND</span> p<span class="p">.</span><span class="k">type</span><span class="o">=</span><span class="s1">'priority'</span>
  <span class="k">WHERE</span> status <span class="k">IN</span> <span class="p">(</span><span class="s1">'new'</span><span class="p">,</span> <span class="s1">'assigned'</span><span class="p">,</span> <span class="s1">'reopened'</span><span class="p">)</span>
  <span class="k">ORDER</span> <span class="k">BY</span> p<span class="p">.</span>value<span class="p">,</span> milestone<span class="p">,</span> severity<span class="p">,</span> time
</pre></div><p>
Note in particular the <tt>LEFT OUTER JOIN</tt> statement here.
</p>
<p>
Note that if your config file uses an uppercase name, e.g.,
</p>
<pre class="wiki">[ticket-custom]

Progress_Type = text
</pre><p>
you would use lowercase in the SQL:  <tt>AND c.name = 'progress_type'</tt>
</p>
<h3 id="Updatingthedatabase">Updating the database</h3>
<p>
As noted above, any tickets created before a custom field has been defined will not have a value for that field. Here's a bit of SQL (tested with SQLite) that you can run directly on the Trac database to set an initial value for custom ticket fields. Inserts the default value of 'None' into a custom field called 'request_source' for all tickets that have no existing value:
</p>
<div class="code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> ticket_custom
   <span class="p">(</span>ticket<span class="p">,</span> name<span class="p">,</span> value<span class="p">)</span>
   <span class="k">SELECT</span> 
      id <span class="k">AS</span> ticket<span class="p">,</span>
      <span class="s1">'request_source'</span> <span class="k">AS</span> name<span class="p">,</span>
      <span class="s1">'None'</span> <span class="k">AS</span> value
   <span class="k">FROM</span> ticket 
   <span class="k">WHERE</span> id <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
      <span class="k">SELECT</span> ticket <span class="k">FROM</span> ticket_custom
   <span class="p">);</span>
</pre></div><p>
If you added multiple custom fields at different points in time, you should be more specific in the subquery on table <tt>ticket</tt> by adding the exact custom field name to the query:
</p>
<div class="code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> ticket_custom
   <span class="p">(</span>ticket<span class="p">,</span> name<span class="p">,</span> value<span class="p">)</span>
   <span class="k">SELECT</span> 
      id <span class="k">AS</span> ticket<span class="p">,</span>
      <span class="s1">'request_source'</span> <span class="k">AS</span> name<span class="p">,</span>
      <span class="s1">'None'</span> <span class="k">AS</span> value
   <span class="k">FROM</span> ticket 
   <span class="k">WHERE</span> id <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
      <span class="k">SELECT</span> ticket <span class="k">FROM</span> ticket_custom <span class="k">WHERE</span> name <span class="o">=</span> <span class="s1">'request_source'</span>
   <span class="p">);</span>
</pre></div><hr />
<p>
See also: <a class="wiki" href="TracTickets.html">TracTickets</a>, <a class="wiki" href="TracIni.html">TracIni</a>
</p>
</div>
          
          <div class="trac-modifiedby">
            <span><a href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?action=diff&amp;version=2" title="Version 2 by trac">Last modified</a> <a class="timeline" href="http://opus.nlpl.eu/letsmt-trac/timeline?from=2015-02-25T21%3A37%3A47Z&amp;precision=second" title="See timeline at Feb 25, 2015, 9:37:47 PM">6 years ago</a></span>
            <span class="trac-print">Last modified on Feb 25, 2015, 9:37:47 PM</span>
          </div>
        
        
      </div>
      

    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/letsmt-trac/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?format=txt">Plain Text</a>
        </li><li>
          <a rel="nofollow" href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?format=tex">Latex</a>
        </li><li class="last">
          <a rel="nofollow" href="http://opus.nlpl.eu/letsmt-trac/wiki/TracTicketsCustomFields?format=pdf">Latex-Pdf</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 1.0.1</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>